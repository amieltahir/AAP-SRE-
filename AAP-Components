
Controller	Core UI/API engine	Manages job templates, projects, inventories, credentials
Automation Hub (Hub)	Stores certified collections	Allows version control and collection management
Execution Environments (EE)	Containerized runtime for Ansible jobs	Built via ansible-builder, ensures reproducible jobs
Database (PostgreSQL)	Stores all metadata and job history	Backup/restore critical for lifecycle management
EDA (Event-Driven Ansible)	Automates event triggers	Rules, Sources, and Actions, can integrate with Webhooks
Navigator (CLI)	Local command line interface	Interacts with AAP using ansible-navigator

####################################


Component	Role	Practical Notes	How to Validate
Controller	Core UI/API engine	The brain of AAP. Manages RBAC, job scheduling, and state management	sudo systemctl status ansible-automation-platform
Database (PostgreSQL)	Stores metadata & job history	Critical for backup/restore. Default: embedded PostgreSQL	sudo awx-manage dbshell then \l
Redis	Message broker & caching	Used for celery task queue and caching	sudo systemctl status redis
Celery Workers	Async task execution	Handles job execution in background	sudo systemctl status awx-celery-worker
Web Service (nginx)	Web UI & API proxy	Serves the UI and proxies API requests	sudo systemctl status nginx or awx-web
Execution Environments	Containerized runtime	Isolated environments for job execution	Check in UI: Administration → Execution Environments

##################################################################

Service name: automation-controller.service
Control script: /usr/bin/automation-controller-service

# Start by checking the current state
echo "=== Current AAP Service Status ==="
sudo systemctl status automation-controller.service
sudo automation-controller-service status

# Check what the service depends on
echo "=== Service Dependencies ==="
sudo systemctl list-dependencies automation-controller.service

# Check if it's enabled to start on boot
echo "=== Service Enablement Status ==="
sudo systemctl is-enabled automation-controller.service

#################################

# Start the automation controller
echo "=== Starting Automation Controller ==="
sudo automation-controller-service start

AAP is actually running via supervisord, not via the systemd service. The automation-controller.service shows "active (exited)" because it just runs /bin/true and doesn't actually manage the services.

sudo supervisorctl status
rsyslog-4xx-recovery                     RUNNING   pid 355431, uptime 22:34:36
tower-processes:awx-callback-receiver    RUNNING   pid 355433, uptime 22:34:36
tower-processes:awx-daphne               RUNNING   pid 355449, uptime 22:34:36
tower-processes:awx-dispatcher           RUNNING   pid 422534, uptime 21:14:26
tower-processes:awx-rsyslog-configurer   RUNNING   pid 355458, uptime 22:34:36
tower-processes:awx-rsyslogd             RUNNING   pid 356043, uptime 22:34:23
tower-processes:awx-uwsgi                RUNNING   pid 355437, uptime 22:34:36
tower-processes:awx-ws-heartbeat         RUNNING   pid 355459, uptime 22:34:36
tower-processes:awx-wsrelay              RUNNING   pid 355456, uptime 22:34:36


# Check the supervisord configuration
echo "=== Supervisord Configuration ==="
sudo cat /etc/supervisord.conf

# Check for AAP-specific supervisord configs
echo "=== AAP Supervisord Configs ==="
sudo find /etc -name "*supervisord*" -type f 2>/dev/null

###############

AAP Architecture:

Process Manager: Supervisord
Key Components: Managed via tower-processes group in supervisord
Web Service: awx-uwsgi + awx-daphne
Task Processing: awx-dispatcher + awx-callback-receiver
Logging: awx-rsyslogd + awx-rsyslog-configurer
WebSocket: awx-wsrelay + awx-ws-heartbeat

###########################################################

 ./aap_healthcheck.sh
===============================================
AAP Health Check - Supervisord Environment
===============================================
=== Supervisord Status ===
rsyslog-4xx-recovery                     RUNNING   pid 355431, uptime 22:44:51
tower-processes:awx-callback-receiver    RUNNING   pid 355433, uptime 22:44:51
tower-processes:awx-daphne               RUNNING   pid 355449, uptime 22:44:51
tower-processes:awx-dispatcher           RUNNING   pid 422534, uptime 21:24:41
tower-processes:awx-rsyslog-configurer   RUNNING   pid 355458, uptime 22:44:51
tower-processes:awx-rsyslogd             RUNNING   pid 356043, uptime 22:44:38
tower-processes:awx-uwsgi                RUNNING   pid 355437, uptime 22:44:51
tower-processes:awx-ws-heartbeat         RUNNING   pid 355459, uptime 22:44:51
tower-processes:awx-wsrelay              RUNNING   pid 355456, uptime 22:44:51

=== Process Counts ===
UWSGI workers: 5
Callback receivers: 5
Dispatchers: 5
Total AAP processes: 20

=== System Resources ===
Memory usage:
USER         PID %CPU %MEM    VSZ   RSS TTY      STAT START   TIME COMMAND
awx       422534  0.2  1.9 646708 151768 ?       Sl   Oct25   3:17 /var/lib/awx/venv/awx/bin/python /usr/bin/awx-manage run_dispatcher
awx       673084  0.2  1.9 650624 149728 ?       Sl   19:21   0:10 /var/lib/awx/venv/awx/bin/python /usr/bin/awx-manage run_dispatcher
awx       673087  0.1  1.8 647392 142560 ?       Sl   19:21   0:06 /var/lib/awx/venv/awx/bin/python /usr/bin/awx-manage run_dispatcher
awx       673089  0.1  1.8 647352 142560 ?       Sl   19:21   0:06 /var/lib/awx/venv/awx/bin/python /usr/bin/awx-manage run_dispatcher
awx       673081  0.1  1.8 647344 142432 ?       Sl   19:21   0:06 /var/lib/awx/venv/awx/bin/python /usr/bin/awx-manage run_dispatcher
awx       355458  0.0  1.8 149432 141584 ?       S    Oct25   0:04 /var/lib/awx/venv/awx/bin/python /usr/bin/awx-manage run_rsyslog_configurer
awx       355433  0.0  1.8 149484 141580 ?       S    Oct25   0:03 /var/lib/awx/venv/awx/bin/python /usr/bin/awx-manage run_callback_receiver
awx       673336  0.1  1.7 154180 137044 ?       S    19:58   0:04 /var/lib/awx/venv/awx/bin/uwsgi --socket /var/run/tower/uwsgi.sock --module=awx.wsgi:application --stats /var/lib/awx/uwsgi.stats --chmod-socket=660 --vacuum --master --no-orphans --buffer-size=32768 --listen=4096 --workers=16 --worker-reload-mercy=30 --harakiri=120 --max-worker-lifetime=3600 --max-requests=100000 --reload-on-rss=1024 --cheaper=4 --cheaper-algo=busyness --cheaper-initial=4 --cheaper-step=2
awx       355456  0.0  1.7 216460 135432 ?       Sl   Oct25   0:24 /var/lib/awx/venv/awx/bin/python /usr/bin/awx-manage run_wsrelay

Disk space:
Filesystem      Size  Used Avail Use% Mounted on
/dev/nvme0n1p4   39G  3.7G   36G  10% /
/dev/nvme0n1p4   39G  3.7G   36G  10% /
/dev/nvme0n1p4   39G  3.7G   36G  10% /

=== API Health ===
✓ API is responsive
✓ AAP Version: unknown

=== Web Interface ===
✓ Web interface is accessible

=== Network Ports ===
tcp        0      0 0.0.0.0:443             0.0.0.0:*               LISTEN      76098/nginx: master
tcp        0      0 0.0.0.0:80              0.0.0.0:*               LISTEN      76098/nginx: master
tcp6       0      0 :::443                  :::*                    LISTEN      76098/nginx: master
tcp6       0      0 :::80                   :::*                    LISTEN      76098/nginx: master

=== Recent Errors ===
No recent errors found

#################################################################################################################################################################################

./aap_service_control.sh
===============================================
AAP Service Control - Supervisord Environment
===============================================
=== Current Status ===
rsyslog-4xx-recovery                     RUNNING   pid 355431, uptime 22:49:54
tower-processes:awx-callback-receiver    RUNNING   pid 355433, uptime 22:49:54
tower-processes:awx-daphne               RUNNING   pid 355449, uptime 22:49:54
tower-processes:awx-dispatcher           RUNNING   pid 422534, uptime 21:29:44
tower-processes:awx-rsyslog-configurer   RUNNING   pid 355458, uptime 22:49:54
tower-processes:awx-rsyslogd             RUNNING   pid 356043, uptime 22:49:41
tower-processes:awx-uwsgi                RUNNING   pid 355437, uptime 22:49:54
tower-processes:awx-ws-heartbeat         RUNNING   pid 355459, uptime 22:49:54
tower-processes:awx-wsrelay              RUNNING   pid 355456, uptime 22:49:54

=== Testing Component Control ===
Testing restart of: awx-uwsgi
Restarting awx-uwsgi...
awx-uwsgi: ERROR (no such process)
awx-uwsgi: ERROR (no such process)
Status: tower-processes:awx-uwsgi                RUNNING   pid 355437, uptime 22:49:58
---
Testing restart of: awx-dispatcher
Restarting awx-dispatcher...
awx-dispatcher: ERROR (no such process)
awx-dispatcher: ERROR (no such process)
Status: tower-processes:awx-dispatcher           RUNNING   pid 422534, uptime 21:29:51
---
Testing restart of: awx-callback-receiver
Restarting awx-callback-receiver...
awx-callback-receiver: ERROR (no such process)
awx-callback-receiver: ERROR (no such process)
Status: tower-processes:awx-callback-receiver    RUNNING   pid 355433, uptime 22:50:05
---

=== Testing Full Restart ===
Restarting all AAP services...
rsyslog-4xx-recovery: stopped
tower-processes:awx-rsyslogd: stopped
tower-processes:awx-wsrelay: stopped
tower-processes:awx-rsyslog-configurer: stopped
tower-processes:awx-ws-heartbeat: stopped
tower-processes:awx-daphne: stopped
tower-processes:awx-dispatcher: stopped
tower-processes:awx-callback-receiver: stopped
tower-processes:awx-uwsgi: stopped
tower-processes:awx-dispatcher: started
tower-processes:awx-callback-receiver: started
tower-processes:awx-uwsgi: started
tower-processes:awx-daphne: started
tower-processes:awx-wsrelay: started
tower-processes:awx-rsyslogd: started
tower-processes:awx-rsyslog-configurer: started
tower-processes:awx-ws-heartbeat: started
rsyslog-4xx-recovery: started

=== Post-Restart Verification ===
rsyslog-4xx-recovery                     RUNNING   pid 674038, uptime 0:00:12
tower-processes:awx-callback-receiver    RUNNING   pid 674040, uptime 0:00:12
tower-processes:awx-daphne               RUNNING   pid 674042, uptime 0:00:12
tower-processes:awx-dispatcher           RUNNING   pid 674039, uptime 0:00:12
tower-processes:awx-rsyslog-configurer   RUNNING   pid 674045, uptime 0:00:12
tower-processes:awx-rsyslogd             RUNNING   pid 674044, uptime 0:00:12
tower-processes:awx-uwsgi                RUNNING   pid 674041, uptime 0:00:12
tower-processes:awx-ws-heartbeat         RUNNING   pid 674046, uptime 0:00:12
tower-processes:awx-wsrelay              RUNNING   pid 674043, uptime 0:00:12

=== API Health Check ===
✓ API responsive after restart
[ec2-user@controller01 ~]$ vi aap_service_control.sh
[ec2-user@controller01 ~]$
[ec2-user@controller01 ~]$
[ec2-user@controller01 ~]$ ./aap_service_control.sh
===============================================
AAP Service Control - Supervisord Environment
===============================================
=== Current Status ===
rsyslog-4xx-recovery                     RUNNING   pid 674038, uptime 0:02:39
tower-processes:awx-callback-receiver    RUNNING   pid 674040, uptime 0:02:39
tower-processes:awx-daphne               RUNNING   pid 674042, uptime 0:02:39
tower-processes:awx-dispatcher           RUNNING   pid 674039, uptime 0:02:39
tower-processes:awx-rsyslog-configurer   RUNNING   pid 674045, uptime 0:02:39
tower-processes:awx-rsyslogd             RUNNING   pid 674097, uptime 0:02:27
tower-processes:awx-uwsgi                RUNNING   pid 674041, uptime 0:02:39
tower-processes:awx-ws-heartbeat         RUNNING   pid 674046, uptime 0:02:39
tower-processes:awx-wsrelay              RUNNING   pid 674043, uptime 0:02:39

=== Testing Component Control ===
Testing restart of: tower-processes:awx-uwsgi
Restarting tower-processes:awx-uwsgi...
tower-processes:awx-uwsgi: stopped
tower-processes:awx-uwsgi: started
Status: tower-processes:awx-uwsgi                RUNNING   pid 674129, uptime 0:00:03
---
Testing restart of: tower-processes:awx-dispatcher
Restarting tower-processes:awx-dispatcher...
tower-processes:awx-dispatcher: stopped
tower-processes:awx-dispatcher: started
Status: tower-processes:awx-dispatcher           RUNNING   pid 674147, uptime 0:00:04
---
Testing restart of: tower-processes:awx-callback-receiver
Restarting tower-processes:awx-callback-receiver...
tower-processes:awx-callback-receiver: stopped
tower-processes:awx-callback-receiver: started
Status: tower-processes:awx-callback-receiver    RUNNING   pid 674165, uptime 0:00:03
---

=== Testing Full Restart ===
Restarting all AAP services...
tower-processes:awx-wsrelay: stopped
rsyslog-4xx-recovery: stopped
tower-processes:awx-rsyslogd: stopped
tower-processes:awx-rsyslog-configurer: stopped
tower-processes:awx-daphne: stopped
tower-processes:awx-ws-heartbeat: stopped
tower-processes:awx-callback-receiver: stopped
tower-processes:awx-dispatcher: stopped
tower-processes:awx-uwsgi: stopped
tower-processes:awx-dispatcher: started
tower-processes:awx-callback-receiver: started
tower-processes:awx-uwsgi: started
tower-processes:awx-daphne: started
tower-processes:awx-wsrelay: started
tower-processes:awx-rsyslogd: started
tower-processes:awx-rsyslog-configurer: started
tower-processes:awx-ws-heartbeat: started
rsyslog-4xx-recovery: started

=== Post-Restart Verification ===
rsyslog-4xx-recovery                     RUNNING   pid 674183, uptime 0:00:12
tower-processes:awx-callback-receiver    RUNNING   pid 674185, uptime 0:00:12
tower-processes:awx-daphne               RUNNING   pid 674187, uptime 0:00:12
tower-processes:awx-dispatcher           RUNNING   pid 674184, uptime 0:00:12
tower-processes:awx-rsyslog-configurer   RUNNING   pid 674190, uptime 0:00:12
tower-processes:awx-rsyslogd             RUNNING   pid 674189, uptime 0:00:12
tower-processes:awx-uwsgi                RUNNING   pid 674186, uptime 0:00:12
tower-processes:awx-ws-heartbeat         RUNNING   pid 674191, uptime 0:00:12
tower-processes:awx-wsrelay              RUNNING   pid 674188, uptime 0:00:12

=== API Health Check ===
✓ API responsive after restart

=== All Available Service Names ===
rsyslog-4xx-recovery
tower-processes:awx-callback-receiver
tower-processes:awx-daphne
tower-processes:awx-dispatcher
tower-processes:awx-rsyslog-configurer
tower-processes:awx-rsyslogd
tower-processes:awx-uwsgi
tower-processes:awx-ws-heartbeat
tower-processes:awx-wsrelay

#################################################################################################################################################################################

./aap_backup_controller_only.sh
===============================================
AAP Backup Operations - Controller Only
===============================================
Backup directory: /opt/backups/aap_controller_20251026_211332
Note: PostgreSQL is hosted on db01 (separate server)
=== Step 1: Stopping Services ===
rsyslog-4xx-recovery: stopped
tower-processes:awx-rsyslogd: stopped
tower-processes:awx-wsrelay: stopped
tower-processes:awx-rsyslog-configurer: stopped
tower-processes:awx-ws-heartbeat: stopped
tower-processes:awx-daphne: stopped
tower-processes:awx-dispatcher: stopped
tower-processes:awx-callback-receiver: stopped
tower-processes:awx-uwsgi: stopped
=== Step 2: Configuration Backup ===
Backing up AAP configurations...
✓ AAP configurations backed up
=== Step 3: Data Directory Backup ===
Backing up /var/lib/awx...
✓ AWX data directory backed up
=== Step 4: Projects and Artifacts Backup ===
✓ Projects backed up
✓ Job artifacts backed up
=== Step 5: Log Backup ===
✓ Log files backed up
=== Step 6: SSL Certificates Backup ===
✓ SSL certificates backed up
=== Step 7: Creating Backup Metadata ===
./aap_backup_controller_only.sh: line 73: /opt/backups/aap_controller_20251026_211332/backup_metadata.txt: Permission denied
./aap_backup_controller_only.sh: line 89: /opt/backups/aap_controller_20251026_211332/RESTORE_INSTRUCTIONS.md: Permission denied
=== Step 8: Restarting Services ===
tower-processes:awx-dispatcher: started
tower-processes:awx-callback-receiver: started
tower-processes:awx-uwsgi: started
tower-processes:awx-daphne: started
tower-processes:awx-wsrelay: started
tower-processes:awx-rsyslogd: started
tower-processes:awx-rsyslog-configurer: started
tower-processes:awx-ws-heartbeat: started
rsyslog-4xx-recovery: started
=== Step 9: Backup Verification ===
Backup contents:
total 141752
drwxr-xr-x. 2 root root       148 Oct 26 21:14 .
drwxr-xr-x. 3 root root        44 Oct 26 21:13 ..
-rw-r--r--. 1 root root     26249 Oct 26 21:13 aap_config.tar.gz
-rw-r--r--. 1 root root 145032106 Oct 26 21:14 awx_data.tar.gz
-rw-r--r--. 1 root root       126 Oct 26 21:14 job_artifacts.tar.gz
-rw-r--r--. 1 root root     63700 Oct 26 21:14 logs.tar.gz
-rw-r--r--. 1 root root       129 Oct 26 21:14 projects.tar.gz
-rw-r--r--. 1 root root     12960 Oct 26 21:14 ssl_certs.tar.gz

Backup size:
139M    /opt/backups/aap_controller_20251026_211332

=== Step 10: Service Recovery Check ===
Service status:
rsyslog-4xx-recovery                     RUNNING   pid 674633, uptime 0:00:32
tower-processes:awx-callback-receiver    RUNNING   pid 674635, uptime 0:00:32
tower-processes:awx-daphne               RUNNING   pid 674637, uptime 0:00:32
tower-processes:awx-dispatcher           RUNNING   pid 674634, uptime 0:00:32
tower-processes:awx-rsyslog-configurer   RUNNING   pid 674640, uptime 0:00:32
tower-processes:awx-rsyslogd             RUNNING   pid 674691, uptime 0:00:19
tower-processes:awx-uwsgi                RUNNING   pid 674636, uptime 0:00:32
tower-processes:awx-ws-heartbeat         RUNNING   pid 674641, uptime 0:00:32
tower-processes:awx-wsrelay              RUNNING   pid 674638, uptime 0:00:32

API check:
✓ API is responsive

=== Backup Complete ===
Backup saved to: /opt/backups/aap_controller_20251026_211332
Important: PostgreSQL backup must be performed separately on db01

##################################################################################################################################################################################################################

./aap_cli_api_operations.sh
===============================================
AAP CLI & API Operations - Fixed Authentication
===============================================
=== Checking Dependencies ===
✓ Dependencies checked
Using stored credentials
=== Creating API Token ===
Testing credentials...
Could not retrieve CSRF token
No valid session. Cannot create token.
Automated token creation failed. Trying manual method...
=== Manual Token Creation Required ===
Automatic token creation failed. Please create a token manually:
1. Open your browser and go to: https://localhost
2. Log in with your credentials
3. Click on your username in the top right
4. Select 'Tokens' from the dropdown
5. Click 'Add' to create a new token
6. Copy the token value and paste it below

Enter your API token: GfMUgkmvn5GngNQQSSHF2kOh7YUuzQ
✓ Token saved to /home/ec2-user/.aap_token
Using existing API token
Testing API connectivity...
✓ API connectivity: SUCCESS
Testing API connectivity...
✓ API connectivity: SUCCESS
✓ Ready to use AAP API
=== User Information ===
Username: null
Email: Not set
Superuser: null
=== Platform Information ===
{
  "version": "4.5.26",
  "install_uuid": null,
  "time_zone": "UTC",
  "license_type": null,
  "project_base_dir": "/var/lib/awx/projects"
}
=== Resource Overview ===
Projects: 0
Inventories: 0
Organizations: 0
Credentials: 0
Job Templates: 0

=== AAP API Operations ===
1) Job Template Operations
2) Test API
3) Exit
Select operation (1-3): 2
Testing API connectivity...
✓ API connectivity: SUCCESS

=== AAP API Operations ===
1) Job Template Operations
2) Test API
3) Exit
Select operation (1-3): 1
=== Job Templates ===

=== AAP API Operations ===
1) Job Template Operations
2) Test API
3) Exit

